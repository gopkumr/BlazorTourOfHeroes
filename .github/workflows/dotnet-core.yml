name: .NET Core

on:
  push:
    branches: [ Perf ]
  pull_request:
    branches: [ Perf ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
      with:
         persist-credentials: false
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 3.1.300
    - name: Install dependencies
      run: dotnet restore
    - name: Build
      run: dotnet build --configuration Release --no-restore
    - name: Publish
      run: dotnet publish --configuration Release --no-restore "/home/runner/work/BlazorTourOfHeroes/BlazorTourOfHeroes/TourofHeroes/TourofHeroes.csproj"
    - name: Publish to GitHub Pages
      run: |
          git init
          git remote add origin https://$REPO_KEY@github.com/gopkumr/BlazorHost.git
          git fetch --prune
          git checkout -b master origin/master
          git rm -r --ignore-unmatch '*'
          git add --all
          git config user.name gopkumr
          git config user.email gopakumar.r@live.com
          git commit -m Publish '/home/runner/work/BlazorTourOfHeroes/BlazorTourOfHeroes/TourofHeroes/bin/Release/netstandard2.1/wwwroot' to 'master' in 'gopkumr/BlazorHost'
          git config push.default current
          git push origin
      env:
        REPO_KEY:${{ secrets.ACCESS_TOKEN }}
